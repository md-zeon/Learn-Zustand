# Zustand Setup & Configuration

This guide covers the installation, configuration, and initial setup of Zustand in your React projects.

## Installation

### 1. **Using npm**

```bash
npm install zustand
```

### 2. **Using yarn**

```bash
yarn add zustand
```

### 3. **Using pnpm**

```bash
pnpm add zustand
```

### Verify Installation

After installation, check your `package.json`:

```json
{
	"dependencies": {
		"zustand": "^4.x.x"
	}
}
```

## Project Setup

### Option A: Create React App with Zustand

```bash
# Create a new React application
npx create-react-app zustand-app

# Navigate to project
cd zustand-app

# Install Zustand
npm install zustand

# Start development server
npm start
```

### Option B: Vite + React

```bash
# Create Vite project
npm create vite@latest zustand-app -- --template react

# Navigate and install
cd zustand-app
npm install zustand

# Start development server
npm run dev
```

## Project Structure

### Recommended Directory Layout

```
src/
├── stores/
│   ├── authStore.js
│   ├── cartStore.js
│   └── userStore.js
├── components/
│   ├── Header.jsx
│   ├── Cart.jsx
│   └── UserProfile.jsx
├── hooks/
│   └── useCustomHooks.js
├── App.jsx
└── index.css
```

### Stores Folder

Keep all Zustand stores in a dedicated `stores/` folder for better organization and maintainability.

## Basic Store Creation

### Simple Store Example

```javascript
// src/stores/counterStore.js
import { create } from "zustand";

const useCounterStore = create((set) => ({
	count: 0,
	increment: () => set((state) => ({ count: state.count + 1 })),
	decrement: () => set((state) => ({ count: state.count - 1 })),
	reset: () => set({ count: 0 }),
}));

export default useCounterStore;
```

### Using the Store in a Component

```javascript
// src/components/Counter.jsx
import useCounterStore from "../stores/counterStore";

function Counter() {
	const count = useCounterStore((state) => state.count);
	const increment = useCounterStore((state) => state.increment);
	const decrement = useCounterStore((state) => state.decrement);

	return (
		<div>
			<p>Count: {count}</p>
			<button onClick={increment}>Increment</button>
			<button onClick={decrement}>Decrement</button>
		</div>
	);
}

export default Counter;
```

## TypeScript Configuration (Optional)

### Install TypeScript

```bash
npm install --save-dev typescript @types/react @types/node
```

### Create TypeScript Store

```typescript
// src/stores/counterStore.ts
import { create } from "zustand";

interface CounterStore {
	count: number;
	increment: () => void;
	decrement: () => void;
	reset: () => void;
}

const useCounterStore = create<CounterStore>((set) => ({
	count: 0,
	increment: () => set((state) => ({ count: state.count + 1 })),
	decrement: () => set((state) => ({ count: state.count - 1 })),
	reset: () => set({ count: 0 }),
}));

export default useCounterStore;
```

### Using TypeScript Store

```typescript
// src/components/Counter.tsx
import useCounterStore from "../stores/counterStore";

function Counter() {
	const { count, increment, decrement } = useCounterStore();

	return (
		<div>
			<p>Count: {count}</p>
			<button onClick={increment}>Increment</button>
			<button onClick={decrement}>Decrement</button>
		</div>
	);
}

export default Counter;
```

## Middleware & Advanced Configuration

### Immer Middleware (for immutable updates)

```bash
npm install immer
```

```javascript
import { create } from "zustand";
import { immer } from "zustand/middleware/immer";

const useBearStore = create(
	immer((set) => ({
		bears: 0,
		increase: () =>
			set((state) => {
				state.bears++;
			}),
	})),
);
```

### DevTools Middleware (for debugging)

```bash
npm install zustand/middleware
```

```javascript
import { create } from "zustand";
import { devtools } from "zustand/middleware";

const useStore = create(
	devtools(
		(set) => ({
			count: 0,
			increment: () => set((state) => ({ count: state.count + 1 })),
		}),
		{ name: "CounterStore" },
	),
);
```

### Persist Middleware (for localStorage)

```javascript
import { create } from "zustand";
import { persist } from "zustand/middleware";

const useAuthStore = create(
	persist(
		(set) => ({
			user: null,
			setUser: (user) => set({ user }),
			logout: () => set({ user: null }),
		}),
		{
			name: "auth-store",
			storage: localStorage,
		},
	),
);
```

## Environment Configuration

### .env File Setup

```bash
# .env
REACT_APP_API_URL=http://localhost:3001
REACT_APP_API_KEY=your_api_key_here
REACT_APP_ENV=development
```

### Using Environment Variables in Stores

```javascript
// src/stores/apiStore.js
import { create } from "zustand";

const useApiStore = create((set) => ({
	apiUrl: process.env.REACT_APP_API_URL,
	apiKey: process.env.REACT_APP_API_KEY,
	// ... rest of store
}));
```

## Configuration Best Practices

### 1. **Store File Naming**

- Use PascalCase: `authStore.js`, `cartStore.js`
- Prefix with `use` for hooks: `useAuthStore`

### 2. **Selector Patterns**

```javascript
// ✅ Good: Specific selectors
const count = useCounterStore((state) => state.count);
const increment = useCounterStore((state) => state.increment);

// ❌ Avoid: Entire state
const store = useCounterStore();
```

### 3. **Separate Concerns**

```javascript
// ✅ Good: Organized stores
useAuthStore.js; // Auth logic
useCartStore.js; // Cart logic
useUserStore.js; // User data

// ❌ Avoid: Single mega-store
megaStore.js; // Everything
```

### 4. **Combine Multiple Stores**

```javascript
// src/hooks/useCombinedStore.js
import useAuthStore from "../stores/authStore";
import useCartStore from "../stores/cartStore";

export const useCombinedStore = () => ({
	auth: useAuthStore(),
	cart: useCartStore(),
});
```

## Common Configuration Issues & Solutions

| Issue                           | Cause                             | Solution                                      |
| ------------------------------- | --------------------------------- | --------------------------------------------- |
| Store not updating in component | Not using selectors properly      | Use specific selector function                |
| Component re-renders too often  | Selecting entire state            | Use selector to pick specific properties      |
| localStorage not persisting     | Persist middleware not configured | Add persist middleware with storage option    |
| TypeScript type errors          | Missing type definitions          | Define interface and use generics in create() |
| DevTools not showing changes    | DevTools middleware missing       | Add devtools middleware                       |

## Testing Setup

### Jest Configuration for Zustand

```javascript
// src/__tests__/counterStore.test.js
import { renderHook, act } from "@testing-library/react";
import useCounterStore from "../stores/counterStore";

describe("counterStore", () => {
	beforeEach(() => {
		useCounterStore.setState({ count: 0 });
	});

	it("should increment count", () => {
		const { result } = renderHook(() => useCounterStore());

		act(() => {
			result.current.increment();
		});

		expect(result.current.count).toBe(1);
	});
});
```

## Verification Checklist

- [ ] Zustand installed via npm/yarn
- [ ] Store folder created in `src/`
- [ ] First store created successfully
- [ ] Store can be imported in components
- [ ] Selectors working correctly
- [ ] (Optional) TypeScript configured
- [ ] (Optional) Middleware installed and working
- [ ] (Optional) DevTools displaying store changes
- [ ] (Optional) LocalStorage persistence working

## Next Steps

Once setup is complete:

1. Review basic store creation
2. Practice creating multiple stores
3. Learn advanced patterns and selectors
4. Explore middleware and plugins
5. Build a small project to reinforce concepts

---

**Next:** Continue to 03.Basic Concepts for understanding core Zustand principles.
